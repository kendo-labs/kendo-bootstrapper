("function"==typeof define&&define.amd?define:function(e,t){return t()})(["./kendo.data.min","./kendo.popup.min"],function(){(function(e,t){function n(t,a){t.filters&&(t.filters=e.grep(t.filters,function(e){return n(e,a),e.filters?e.filters.length:e.field!=a}))}var a=window.kendo,i=a.ui,r=i.Widget,o=a.keys,l=a.htmlEncode,s="id",u="li",d="change",c="character",f="k-state-focused",p="k-state-hover",_="k-loading",h="open",v="close",m="select",g="progress",b="requestEnd",x="width",S=e.extend,y=e.proxy,w=a.support.browser,k=w.msie&&9>w.version,F=/"/g,C={ComboBox:"DropDownList",DropDownList:"ComboBox"},I=r.extend({init:function(t,n){var i,o=this,l=o.ns;r.fn.init.call(o,t,n),t=o.element,o._template(),o.ul=e('<ul unselectable="on" class="k-list k-reset"/>').css({overflow:a.support.kineticScrollNeeded?"":"auto"}).on("mouseenter"+l,u,function(){e(this).addClass(p)}).on("mouseleave"+l,u,function(){e(this).removeClass(p)}).on("click"+l,u,y(o._click,o)).attr({tabIndex:-1,role:"listbox","aria-hidden":!0}),o.list=e("<div class='k-list-container'/>").append(o.ul).on("mousedown"+l,function(e){e.preventDefault()}),i=t.attr(s),i&&(o.list.attr(s,i+"-list"),o.ul.attr(s,i+"_listbox"),o._optionID=i+"_option_selected")},_ignoreCase:function(){var e,t=this,n=t.dataSource.reader.model;n&&n.fields&&(e=n.fields[t.options.dataTextField],e&&e.type&&"string"!==e.type&&(t.options.ignoreCase=!1))},items:function(){return this.ul[0].children},current:function(e){var n=this,a=n._optionID;return e===t?n._current:(n._current&&(n._current.removeClass(f).removeAttr("aria-selected").removeAttr(s),n._focused.removeAttr("aria-activedescendant")),e&&(e.addClass(f),n._scroll(e),a&&(e.attr("id",a),n._focused.attr("aria-activedescendant",a))),n._current=e,t)},destroy:function(){var e=this,t=e.ns;r.fn.destroy.call(e),e._unbindDataSource(),e.ul.off(t),e.list.off(t),e.popup.destroy(),e._form&&e._form.off("reset",e._resetHandler)},dataItem:function(e){var n=this;return e===t&&(e=n.selectedIndex),n._data()[e]},_accessors:function(){var e=this,t=e.element,n=e.options,i=a.getter,r=t.attr(a.attr("text-field")),o=t.attr(a.attr("value-field"));r&&(n.dataTextField=r),o&&(n.dataValueField=o),e._text=i(n.dataTextField),e._value=i(n.dataValueField)},_aria:function(e){var n=this,a=n.options,i=n._focused;a.suggest!==t&&i.attr("aria-autocomplete",a.suggest?"both":"list"),e=e?e+" "+n.ul[0].id:n.ul[0].id,i.attr("aria-owns",e),n.ul.attr("aria-live",a.filter&&"none"!==a.filter?"polite":"off")},_blur:function(){var e=this;e._change(),e.close()},_change:function(){var e,n=this,a=n.selectedIndex,i=n.value();i!==n._old?e=!0:a!==t&&a!==n._oldIndex&&(e=!0),e&&(n._old=i,n._oldIndex=a,n.trigger(d),n.element.trigger(d))},_click:function(t){t.isDefaultPrevented()||this._accept(e(t.currentTarget))},_data:function(){return this.dataSource.view()},_enable:function(){var e=this,t=e.options;e.element.prop("disabled")&&(t.enable=!1),e.enable(t.enable)},_focus:function(e){var n=this;return n.popup.visible()&&e&&n.trigger(m,{item:e})?(n.close(),t):(n._select(e),n._triggerCascade(),n._blur(),t)},_index:function(e){var t,n,a=this,i=a._data();for(t=0,n=i.length;n>t;t++)if(a._dataValue(i[t])==e)return t;return-1},_dataValue:function(e){var n=this._value(e);return n===t&&(n=this._text(e)),n},_height:function(e){if(e){var t=this,n=t.list,a=t.popup.visible(),i=t.options.height;n=n.add(n.parent(".k-animation-container")).show().height(t.ul[0].scrollHeight>i?i:"auto"),a||n.hide()}},_adjustListWidth:function(){var e,t,n=this.list,a=n[0].style.width,i=this.wrapper;if(n.data(x)||!a)return e=window.getComputedStyle?window.getComputedStyle(i[0],null):0,t=e?parseFloat(e.width):i.outerWidth(),e&&(w.mozilla||w.msie)&&(t+=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight)+parseFloat(e.borderLeftWidth)+parseFloat(e.borderRightWidth)),a=t-(n.outerWidth()-n.width()),n.css({fontFamily:i.css("font-family"),width:a}).data(x,a),!0},_popup:function(){var e=this,t=e.list,n=e._focused,r=e.options,o=e.wrapper;e.popup=new i.Popup(t,S({},r.popup,{anchor:o,open:function(t){e._adjustListWidth(),e.trigger(h)?t.preventDefault():(n.attr("aria-expanded",!0),e.ul.attr("aria-hidden",!1))},close:function(t){e.trigger(v)?t.preventDefault():(n.attr("aria-expanded",!1),e.ul.attr("aria-hidden",!0))},animation:r.animation,isRtl:a.support.isRtl(o)})),e._touchScroller=a.touchScroller(e.popup.element)},_makeUnselectable:function(){k&&this.list.find("*").attr("unselectable","on")},_toggleHover:function(t){e(t.currentTarget).toggleClass(p,"mouseenter"===t.type)},_toggle:function(e){var n=this;e=e!==t?e:!n.popup.visible(),a.support.mobileOS||n._focused[0]===document.activeElement||n._focused.focus(),n[e?h:v]()},_scroll:function(e){if(e){e[0]&&(e=e[0]);var t=this.ul[0],n=e.offsetTop,a=e.offsetHeight,i=t.scrollTop,r=t.clientHeight,o=n+a;t.scrollTop=i>n?n:o>i+r?o-r:i}},_template:function(){var e=this,t=e.options,n=t.template,i=t.dataSource;e.element.is(m)&&e.element[0].length&&(i||(t.dataTextField=t.dataTextField||"text",t.dataValueField=t.dataValueField||"value")),n?(n=a.template(n),e.template=function(e){return'<li tabindex="-1" role="option" unselectable="on" class="k-item">'+n(e)+"</li>"}):e.template=a.template('<li tabindex="-1" role="option" unselectable="on" class="k-item">${'+a.expr(t.dataTextField,"data")+"}</li>",{useWithBlock:!1})},_triggerCascade:function(){this._old!==this.value()&&this.trigger("cascade")},_unbindDataSource:function(){var e=this;e.dataSource.unbind(d,e._refreshHandler).unbind(g,e._progressHandler).unbind(b,e._requestEndHandler)}});S(I,{caret:function(e){var t,n=e.ownerDocument.selection;return t=n?Math.abs(n.createRange().moveStart(c,-e.value.length)):e.selectionStart},selectText:function(e,t,n){try{if(e.createTextRange){e.focus();var a=e.createTextRange();a.collapse(!0),a.moveStart(c,t),a.moveEnd(c,n-t),a.select()}else e.setSelectionRange(t,n)}catch(i){}},inArray:function(e,t){var n,a,i=t.children;if(!e||e.parentNode!==t)return-1;for(n=0,a=i.length;a>n;n++)if(e===i[n])return n;return-1}}),a.ui.List=I,i.Select=I.extend({init:function(e,t){I.fn.init.call(this,e,t),this._initial=this.element.val()},setDataSource:function(e){this.options.dataSource=e,this._dataSource(),this.options.autoBind&&this.dataSource.fetch()},close:function(){this.popup.close()},select:function(e){var n=this;return e===t?n.selectedIndex:(n._select(e),n._triggerCascade(),n._old=n._accessor(),n._oldIndex=n.selectedIndex,t)},_accessor:function(e,n){var a,i,r=this.element,o=r.is(m);return r=r[0],e===t?(o?(i=r.selectedIndex,i>-1&&(a=r.options[i],a&&(e=a.value))):e=r.value,e):(o?r.selectedIndex=n:r.value=e,t)},_hideBusy:function(){var e=this;clearTimeout(e._busy),e._arrow.removeClass(_),e._focused.attr("aria-busy",!1),e._busy=null},_showBusy:function(){var e=this;e._request=!0,e._busy||(e._busy=setTimeout(function(){e._focused.attr("aria-busy",!0),e._arrow.addClass(_)},100))},_requestEnd:function(){this._request=!1},_dataSource:function(){var t,n=this,i=n.element,r=n.options,o=r.dataSource||{};o=e.isArray(o)?{data:o}:o,i.is(m)&&(t=i[0].selectedIndex,t>-1&&(r.index=t),o.select=i,o.fields=[{field:r.dataTextField},{field:r.dataValueField}]),n.dataSource&&n._refreshHandler?n._unbindDataSource():(n._refreshHandler=y(n.refresh,n),n._progressHandler=y(n._showBusy,n),n._requestEndHandler=y(n._requestEnd,n)),n.dataSource=a.data.DataSource.create(o).bind(d,n._refreshHandler).bind(g,n._progressHandler).bind(b,n._requestEndHandler)},_get:function(t){var n,a,i=this,r=i._data();if("function"==typeof t)for(n=0,a=r.length;a>n;n++)if(t(r[n])){t=n;break}if("number"==typeof t){if(0>t)return e();t=e(i.ul[0].children[t])}return t&&t.nodeType&&(t=e(t)),t},_move:function(e){var t,n=this,a=e.keyCode,i=n.ul[0],r=n.popup.visible()?"_select":"_accept",l=n._current,s=a===o.DOWN;return a===o.UP||s?(e.altKey?n.toggle(s):s?(l=!l||-1===n.selectedIndex&&!n.value()?i.firstChild:l[0].nextSibling,n[r](l)):n[r](l?l[0].previousSibling:i.lastChild),e.preventDefault(),t=!0):a===o.ENTER||a===o.TAB?(n.popup.visible()&&e.preventDefault(),n._accept(l),t=!0):a===o.ESC&&(n.popup.visible()&&e.preventDefault(),n.close(),t=!0),t},_selectItem:function(e){var t=this,n=t.options;e=t._selectedValue||n.value||t._accessor(),e?t.value(e):t.select(n.index)},_fetchItems:function(e){var n=this,a=n.ul[0].firstChild;return n._request?!0:n._fetch||a?t:n.options.cascadeFrom?!a:(n.dataSource.one(d,function(){n.value(e),n._fetch=!1}),n._fetch=!0,n.dataSource.fetch(),!0)},_options:function(e,n){var a,i,r,o,s=this,u=s.element,d=u[0].selectedIndex,c=e.length,f="",p=0;for(n&&(f=n,d+=1,p=1);c>p;p++)a="<option",i=e[p],r=s._text(i),o=s._value(i),o!==t&&(o+="",-1!==o.indexOf('"')&&(o=o.replace(F,"&quot;")),a+=' value="'+o+'"'),a+=">",r!==t&&(a+=l(r)),a+="</option>",f+=a;u.html(f),u[0].selectedIndex=d},_reset:function(){var e=this,t=e.element,n=t.closest("form");n[0]&&(e._resetHandler=function(){setTimeout(function(){e.value(e._initial)})},e._form=n.on("reset",e._resetHandler))},_cascade:function(){var t,a,i,r,o,l=this,s=l.options,u=s.cascadeFrom;if(u){if(l._selectedValue=s.value||l._accessor(),a=e("#"+u),t=a.data("kendo"+s.name),t||(t=a.data("kendo"+C[s.name])),!t)return;r=t.options.dataValueField,o=function(){var e=l._selectedValue||l.value();e?(l.value(e),l.dataSource.view()[0]&&-1!==l.selectedIndex||l._clearSelection(t,!0)):l.select(s.index),l.enable()},i=function(){var e,a,i=t.dataItem(),s=i?t._value(i):null;s?(e=l.dataSource.filter()||{},n(e,r),a=e.filters||[],a.push({field:r,operator:"eq",value:s}),l.dataSource.one(d,o).filter(a)):(l.enable(!1),l._clearSelection(t)),l._triggerCascade()},t.bind("cascade",function(){i()}),t._bound?i():t.value()||l.enable(!1)}}}),i.Select.removeFiltersForField=n})(window.kendo.jQuery)});