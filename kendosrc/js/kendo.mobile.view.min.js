("function"==typeof define&&define.amd?define:function(e,t){return t()})(["./kendo.core.min","./kendo.fx.min","./kendo.mobile.scroller.min"],function(){(function(e,t){function n(e){var t,n,i=e.find(g("popover")),o=s.roles;for(t=0,n=i.length;n>t;t++)a.initWidget(i[t],{},o)}function i(e,t){e[0]&&t[0]&&e[0]!=t[0]&&e.kendoAnimateTo(t,{effects:"fade"})}function o(t){t.each(function(){a.initWidget(e(this),{},s.roles)})}function r(e){for(var t=e.split("?")[1]||"",n={},i=t.split(/&|=/),o=i.length,r=0;o>r;r+=2)n[i[r]]=i[r+1];return n}var a=window.kendo,l=a.mobile,s=l.ui,d=a.attr,c=a.Class,h=s.Widget,u="init",f="show",p="beforeShow",m="hide",v="z-index",w=a.attrValue,g=a.roleSelector,y=h.extend({init:function(t,n){var i=this;h.fn.init.call(i,t,n),t=i.element,i.params={},i.lastParams={},e.extend(i,n),i._layout(),i._scroller(),i._model()},events:[u,p,f,m],options:{name:"View",title:"",reload:!1,defaultTransition:"",stretch:!1,zoom:!1,model:null},destroy:function(){h.fn.destroy.call(this),this.scroller&&this.scroller.destroy(),a.destroy(this.element)},purge:function(){this.destroy(),this.element.remove()},showStart:function(){var e=this;e.element.css("display",""),e.inited||(e.inited=!0,e.trigger(u,{view:e})),e.layout&&e.layout.attach(e),e.trigger(f,{view:e})},hideStart:function(){var e=this;e.layout&&e.layout.detach(e)},hideComplete:function(){var e=this;e.element.hide(),e.trigger(m,{view:e})},updateParams:function(e){var t=this;t.trigger(p,{view:t})||(t.lastParams=t.params,t.params=e,t.trigger(f,{view:t}))},switchWith:function(e,t,n,i){var o=this;o.trigger(p,{view:o})||(o.lastParams=o.params,o.params=n,e?(e.hideStart(),o.showStart(),new _({current:e,next:o,transition:t,defaultTransition:e.options.defaultTransition,complete:i})):(o.showStart(),i()))},parallaxContents:function(e){var t=this,n=t.content;return e.header[0]||(n=n.add(t.header)),e.footer[0]||(n=n.add(t.footer)),n},contentElement:function(){var e=this;return e.options.stretch?e.content:e.scrollerContent},_scroller:function(){var e=this;e.options.stretch?e.content.addClass("km-stretched-view"):(e.content.kendoMobileScroller({zoom:e.options.zoom}),e.scroller=e.content.data("kendoMobileScroller"),e.scrollerContent=e.scroller.scrollElement)},_model:function(){var e=this,t=e.element,i=e.options.model;"string"==typeof i&&(i=a.getter(i)(window)),e.model=i,n(t),i?a.bind(t.children(),i,s,a.ui,a.dataviz.ui):l.init(t.children())},_layout:function(){var e=this,t=g("content"),n=e.element;n.data("kendoView",e).addClass("km-view"),e.transition=w(n,"transition"),e.header=n.children(g("header")).addClass("km-header"),e.footer=n.children(g("footer")).addClass("km-footer"),n.children(t)[0]||n.wrapInner("<div "+d("role")+'="content"></div>'),e.content=n.children(g("content")).addClass("km-content"),e.element.prepend(e.header).append(e.footer),e.id=w(n,"url")||"#"+n.attr("id"),e.layout&&e.layout.setup(e)}}),_=c.extend({init:function(t){e.extend(this,t);var n=this,o=n.current,r=n.next,a=o.element,l=r.element,s=r,d=o,c=n._transition();c.reverse&&!c.parallax&&(s=o,d=r),s.element.css(v,1),d.element.css(v,0),c.parallax&&(i(o.footer,r.footer),i(o.header,r.header),a=o.parallaxContents(r),l=r.parallaxContents(o)),a.kendoAnimateTo(l,c),n.back()||(o.nextView=r,o.backTransition=c.transition)},_transition:function(){var e=this,t=e.current,n=e.next,i=e.back(),o=function(){t.hideComplete(),e.complete()},r=i?n.backTransition:n.transition,a=e.transition||r||e.defaultTransition,l=a.split(" "),s=l[0],d=/^slide/.test(s),c="reverse"===l[1];return e.back()&&!e.transition&&(c=!c),{effects:s,reverse:c,parallax:d,complete:o,transition:a}},back:function(){var e=this.next,t=this.current;return e.nextView===t&&JSON.stringify(e.params)===JSON.stringify(e.lastParams)}}),x=h.extend({init:function(e,t){var i=this;h.fn.init.call(i,e,t),e=i.element,i.element=e.detach(),i.header=e.children(g("header")).addClass("km-header"),i.footer=e.children(g("footer")).addClass("km-footer"),i.elements=i.header.add(i.footer),n(e),a.mobile.init(i.element.children()),i.trigger(u,{layout:i})},options:{name:"Layout"},events:[u,f,m],setup:function(e){e.header[0]||(e.header=this.header),e.footer[0]||(e.footer=this.footer)},detach:function(e){var t=this;e.header===t.header&&e.element.prepend(t.header.detach().clone(!0)),e.footer===t.footer&&e.element.append(t.footer.detach().clone(!0)),t.trigger(m,{layout:t,view:e})},attach:function(e){var t=this;e.header===t.header&&(t.header.detach(),e.element.children(g("header")).remove(),e.element.prepend(t.header)),e.footer===t.footer&&(t.footer.detach(),e.element.children(g("footer")).remove(),e.element.append(t.footer)),t.trigger(f,{layout:t,view:e})}}),b=a.Observable,k=/<body[^>]*>(([\u000a\u000d\u2028\u2029]|.)*)<\/body>/i,V="loadStart",C="loadComplete",S="showStart",T="viewShow",W=b.extend({init:function(t){var n,i,r=this;if(b.fn.init.call(r),e.extend(r,t),r.sandbox=e("<div />"),i=r.container,n=r._hideViews(i),r.rootView=n.first(),!r.rootView[0])throw Error('Your kendo mobile application element does not contain any direct child elements with data-role="view" attribute set. Make sure that you instantiate the mobile application using the correct container.');r._view=null,r.layouts={},r._setupLayouts(i),o(i.children(g("modalview"))),r.loader&&(r.bind(S,function(){r.loader.transition()}),r.bind(V,function(){r.loader.show()}),r.bind(C,function(){r.loader.hide()}),r.bind(T,function(){r.loader.transitionDone()}))},view:function(){return this._view},showView:function(e,t){var n,i,o=this,a=o.container,s=r(e),c=e.split("?")[0];e!==o.url&&(o.url=e,o.trigger(S),l.application&&l.application.element&&l.application.element.css("pointer-events","none"),e&&"/"!==e?(i=a.children("["+d("url")+"='"+c+"']"),i[0]||-1!==c.indexOf("/")||(i=a.children("#"===c.charAt(0)?c:"#"+c))):i=o.rootView,n=i.data("kendoView"),n&&n.reload&&(n.purge(),i=[]),i[0]?(n||(n=o._createView(i)),o._show(n,t,s)):o._loadView(e,function(e){o._show(e,t,s)}))},_createView:function(e){var n,i=this,o=w(e,"layout");return o===t&&(o=i.layout),o&&(o=i.layouts[o]),n={defaultTransition:i.transition,loader:i.loader,container:i.container,layout:o,reload:w(e,"reload")},a.initWidget(e,n,s.roles)},_loadView:function(t,n){var i=this;i._xhr&&i._xhr.abort(),i.trigger(V),i._xhr=e.get(t,function(e){i.trigger(C),n(i._createRemoteView(t,e))},"html").fail(function(e){i.trigger(C),0===e.status&&e.responseText&&n(i._createRemoteView(t,e.responseText))})},_createRemoteView:function(e,t){var n,i,r,a=this,l=a.sandbox,s=e.split("?")[0],c=a.container;return k.test(t)&&(t=RegExp.$1),l[0].innerHTML=t,c.append(l.children("script, style")),n=a._hideViews(l),r=n.first(),r.hide().attr(d("url"),s),a._setupLayouts(l),i=l.children(g("modalview")),c.append(l.children(g("layout modalview")).add(n)),o(i),a._createView(r)},_show:function(e,t,n){var i=this,o=l.application&&l.application.element;i._view!==e?e.switchWith(i._view,t,n,function(){i._view=e,o&&l.application.element.css("pointer-events",""),i.trigger(T,{view:e})}):(o&&l.application.element.css("pointer-events",""),i._view.updateParams(n),i.trigger(T,{view:e}))},_hideViews:function(e){return e.children(g("view splitview")).hide()},_setupLayouts:function(n){var i=this;n.children(g("layout")).each(function(){var n=e(this),o=w(n,"platform");(o===t||o===l.application.os.name)&&(i.layouts[n.data("id")]=a.initWidget(n,{},s.roles))})}});a.mobile.ViewEngine=W,s.plugin(y),s.plugin(x)})(window.kendo.jQuery)});